<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Better Programmer - Premium Programming E-Books Library</title>
    <!-- Google Fonts & Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@48,400,0,0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ===== CSS Variables & Reset ===== */
        :root {
            --primary-bg: #0a0a0f;
            --secondary-bg: #0f1117;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-color: #1e293b;
            --border-light: #334155;
            --glass-bg: rgba(30, 41, 59, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
            --card-bg: rgba(15, 23, 42, 0.8);
            --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.4);
            --shadow-xl: 0 25px 50px rgba(0, 0, 0, 0.5);
            --gradient-primary: linear-gradient(135deg, #3b82f6, #8b5cf6);
            --gradient-secondary: linear-gradient(135deg, #10b981, #3b82f6);
            --gradient-dark: linear-gradient(135deg, #0f172a, #1e293b);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ===== Utility Classes ===== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section {
            padding: 100px 0;
        }

        .section-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin-bottom: 3rem;
        }

        /* ===== Background Effects ===== */
        .bg-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .gradient-circle {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.15;
        }

        .circle-1 {
            width: 600px;
            height: 600px;
            background: var(--accent-blue);
            top: -300px;
            right: -200px;
        }

        .circle-2 {
            width: 500px;
            height: 500px;
            background: var(--accent-purple);
            bottom: -200px;
            left: -200px;
        }

        .grid-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(to right, rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.5;
        }

        /* ===== Header & Navigation ===== */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            background: rgba(10, 10, 15, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .logo-text {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--text-primary), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-box {
            position: relative;
            width: 300px;
        }

        .search-input {
            width: 100%;
            padding: 10px 40px 10px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .cart-btn {
            position: relative;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cart-btn:hover {
            color: var(--accent-blue);
            border-color: var(--accent-blue);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-orange);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .auth-btn {
            padding: 10px 24px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
        }

        /* ===== Hero Section ===== */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            padding-top: 100px;
            position: relative;
            overflow: hidden;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 5rem;
            font-weight: 800;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple), #f472b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-shift 8s ease infinite;
            background-size: 200% 200%;
        }

        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin: 3rem 0;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .btn {
            padding: 12px 32px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            font-size: 1rem;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* ===== Books Section ===== */
        .books-section {
            background: var(--gradient-dark);
            position: relative;
        }

        .books-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .filters-container {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 3rem;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .filter-select {
            padding: 10px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.9rem;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .filter-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        /* ===== Book Card Design ===== */
        .book-card {
            background: var(--card-bg);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .book-card:hover {
            transform: translateY(-8px);
            border-color: var(--accent-blue);
            box-shadow: var(--shadow-xl);
        }

        .book-cover {
            position: relative;
            height: 240px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.5), rgba(15, 23, 42, 0.8));
            overflow: hidden;
        }

        .book-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .book-card:hover .book-image {
            transform: scale(1.05);
        }

        .book-badges {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .badge-free {
            background: linear-gradient(135deg, var(--accent-green), #34d399);
            color: black;
        }

        .badge-new {
            background: linear-gradient(135deg, var(--accent-blue), #60a5fa);
            color: white;
        }

        .badge-popular {
            background: linear-gradient(135deg, var(--accent-purple), #a78bfa);
            color: white;
        }

        .book-info {
            padding: 1.5rem;
        }

        .book-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .book-author {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .book-description {
            color: var(--text-muted);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .book-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-top: 1px solid var(--border-light);
            margin-bottom: 1rem;
        }

        .book-category {
            padding: 4px 12px;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--accent-blue);
        }

        .book-rating {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--accent-orange);
        }

        .book-price-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .book-price {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .book-price-free {
            color: var(--accent-green);
        }

        .book-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .btn-small {
            padding: 10px 16px;
            font-size: 0.9rem;
        }

        .btn-fullwidth {
            grid-column: 1 / -1;
        }

        /* ===== Main Content Container for Pages ===== */
        #mainContent {
            min-height: 60vh;
            padding-top: 140px;
        }

        /* ===== Pages Styling ===== */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        .page.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Categories Page */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }
        .category-card {
            background: var(--card-bg);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        .category-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-5px);
        }
        .category-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--accent-blue);
        }

        /* FAQ Page */
        .faq-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .faq-item {
            background: var(--card-bg);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
        }
        .faq-question {
            padding: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .faq-answer {
            padding: 0 1.5rem 1.5rem;
            color: var(--text-secondary);
            display: none;
        }
        .faq-item.active .faq-answer {
            display: block;
        }

        /* Profile Page */
        .profile-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        .profile-avatar {
            width: 120px;
            height: 120px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin: 0 auto 1.5rem;
        }
        .profile-info {
            background: var(--card-bg);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            padding: 2rem;
            max-width: 600px;
            margin: 0 auto;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-light);
        }
        .info-row:last-child {
            border-bottom: none;
        }

        /* Admin Page */
        .admin-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .books-list {
            background: var(--card-bg);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 1.5rem;
        }
        .book-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--border-light);
        }
        .book-list-item:last-child {
            border-bottom: none;
        }

        /* ===== Modal System ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .modal {
            background: var(--card-bg);
            border: 1px solid var(--border-light);
            border-radius: 24px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-xl);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: 2rem;
            border-bottom: 1px solid var(--border-light);
            position: relative;
        }

        .modal-title {
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .modal-close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            color: var(--accent-blue);
            border-color: var(--accent-blue);
        }

        .modal-body {
            padding: 2rem;
        }

        /* ===== Forms ===== */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* ===== Payment Cards ===== */
        .payment-cards {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .payment-card {
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-card:hover {
            border-color: var(--accent-blue);
            background: rgba(59, 130, 246, 0.05);
        }

        .payment-card.selected {
            border-color: var(--accent-blue);
            background: rgba(59, 130, 246, 0.1);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .payment-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .payment-card-type {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .payment-card-number {
            font-family: monospace;
            color: var(--text-secondary);
        }

        .add-card-btn {
            width: 100%;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.03);
            border: 2px dashed var(--border-light);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-card-btn:hover {
            border-color: var(--accent-blue);
            color: var(--accent-blue);
            background: rgba(59, 130, 246, 0.05);
        }

        /* ===== Footer ===== */
        .footer {
            background: var(--secondary-bg);
            padding: 4rem 0 2rem;
            border-top: 1px solid var(--border-light);
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-section h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-links a:hover {
            color: var(--accent-blue);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid var(--border-light);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* ===== Toast Notifications ===== */
        .toast-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9999;
        }

        .toast {
            background: var(--card-bg);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            border-left: 4px solid var(--accent-green);
        }

        .toast.error {
            border-left: 4px solid #ef4444;
        }

        .toast.warning {
            border-left: 4px solid var(--accent-orange);
        }

        /* ===== Responsive Design ===== */
        @media (max-width: 1200px) {
            .hero-title {
                font-size: 4rem;
            }
            
            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .navbar {
                flex-wrap: wrap;
            }
            
            .search-box {
                order: 3;
                width: 100%;
                margin-top: 1rem;
            }
            
            .hero-title {
                font-size: 3rem;
            }
            
            .section-title {
                font-size: 2.5rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-stats {
                gap: 2rem;
            }
            
            .stat-number {
                font-size: 2rem;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .book-actions {
                grid-template-columns: 1fr;
            }
            
            .modal {
                width: 95%;
                margin: 1rem;
            }
        }

        @media (max-width: 480px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .book-card {
                min-width: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Background Effects -->
    <div class="bg-effects">
        <div class="gradient-circle circle-1"></div>
        <div class="gradient-circle circle-2"></div>
        <div class="grid-pattern"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo">
                    <div class="logo-icon">
                        <span class="material-symbols-rounded">code</span>
                    </div>
                    <span class="logo-text">BetterProgrammer</span>
                </a>

                <ul class="nav-links">
                    <li><a href="#" class="nav-link active" data-page="home">
                        <span class="material-symbols-rounded">home</span>
                        Home
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="books">
                        <span class="material-symbols-rounded">menu_book</span>
                        books
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="categories">
                        <span class="material-symbols-rounded">category</span>
                        Categories
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="faq">
                        <span class="material-symbols-rounded">help</span>
                        FAQ
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="profile">
                        <span class="material-symbols-rounded">person</span>
                        Profile
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="admin" id="adminNavLink" style="display: none;">
                        <span class="material-symbols-rounded">admin_panel_settings</span>
                        Admin
                    </a></li>
                </ul>

                <div class="header-actions">
                    <div class="search-box">
                        <input type="text" class="search-input" placeholder="Search books..." id="searchInput">
                        <span class="material-symbols-rounded search-icon">search</span>
                    </div>
                    
                    <button class="cart-btn" id="cartBtn">
                        <span class="material-symbols-rounded">shopping_cart</span>
                        <span class="cart-count" id="cartCount">0</span>
                    </button>
                    
                    <button class="auth-btn" id="authBtn">sign-in</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content Container for All Pages -->
    <main id="mainContent">
        <!-- Home Page (Hero) -->
        <section class="page active" id="homePage">
            <div class="hero">
                <div class="container">
                    <div class="hero-content">
                        <h1 class="hero-title">Master Programming with Premium E-Books</h1>
                        <p class="hero-subtitle">
                            Access the largest collection of programming books written by industry experts. 
                            From beginner tutorials to advanced algorithms, everything you need to level up your skills.
                        </p>
                        
                        <div class="hero-stats">
                            <div class="stat-item">
                                <div class="stat-number" id="totalBooks">500+</div>
                                <div class="stat-label">E-Books</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="totalAuthors">150+</div>
                                <div class="stat-label">Expert Authors</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="activeReaders">10K+</div>
                                <div class="stat-label">Active Readers</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="avgRating">4.8</div>
                                <div class="stat-label">Avg Rating</div>
                            </div>
                        </div>

                        <div class="cta-buttons">
                            <button class="btn btn-primary" id="exploreBtn">
                                <span class="material-symbols-rounded">explore</span>
                                Explore Library
                            </button>
                            <button class="btn btn-secondary" id="joinFreeBtn">
                                <span class="material-symbols-rounded">person_add</span>
                                Join Free
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Books Page -->
        <section class="page books-section" id="booksPage">
            <div class="container">
                <div class="books-header">
                    <h2 class="section-title">Programming E-Books Collection</h2>
                    <p class="section-subtitle">Browse our curated collection of programming books. Filter by category, difficulty, or price range.</p>
                </div>

                <!-- Filters -->
                <div class="filters-container">
                    <div class="filters-grid">
                        <div class="filter-group">
                            <label class="filter-label">
                                <span class="material-symbols-rounded">category</span>
                                Category
                            </label>
                            <select class="filter-select" id="categoryFilter">
                                <option value="all">All Categories</option>
                                <option value="web">Web Development</option>
                                <option value="mobile">Mobile Development</option>
                                <option value="data">Data Science</option>
                                <option value="ai">AI & Machine Learning</option>
                                <option value="devops">DevOps</option>
                                <option value="algorithms">Algorithms</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label class="filter-label">
                                <span class="material-symbols-rounded">attach_money</span>
                                Price Range
                            </label>
                            <select class="filter-select" id="priceFilter">
                                <option value="all">All Prices</option>
                                <option value="free">Free Only</option>
                                <option value="paid">Paid Only</option>
                                <option value="under-20">Under $20</option>
                                <option value="20-50">$20 - $50</option>
                                <option value="over-50">Over $50</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label class="filter-label">
                                <span class="material-symbols-rounded">sort</span>
                                Sort By
                            </label>
                            <select class="filter-select" id="sortFilter">
                                <option value="popular">Most Popular</option>
                                <option value="newest">Newest First</option>
                                <option value="rating">Highest Rated</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label class="filter-label">
                                <span class="material-symbols-rounded">school</span>
                                Difficulty
                            </label>
                            <select class="filter-select" id="difficultyFilter">
                                <option value="all">All Levels</option>
                                <option value="beginner">Beginner</option>
                                <option value="intermediate">Intermediate</option>
                                <option value="advanced">Advanced</option>
                            </select>
                        </div>
                    </div>

                    <div class="filter-actions">
                        <button class="btn btn-secondary" id="resetFilters">
                            <span class="material-symbols-rounded">restart_alt</span>
                            Reset Filters
                        </button>
                    </div>
                </div>

                <!-- Books Grid -->
                <div class="books-grid" id="booksGrid">
                    <!-- Books will be loaded here dynamically -->
                </div>

                <!-- Load More Button -->
                <div style="text-align: center; margin-top: 3rem;">
                    <button class="btn btn-secondary" id="loadMoreBtn">
                        <span class="material-symbols-rounded">expand_more</span>
                        Load More Books
                    </button>
                </div>
            </div>
        </section>

        <!-- Categories Page -->
        <section class="page" id="categoriesPage">
            <div class="container section">
                <h2 class="section-title">Book Categories</h2>
                <p class="section-subtitle">Explore programming books by category to find exactly what you're looking for.</p>
                
                <div class="categories-grid" id="categoriesGrid">
                    <!-- Categories will be loaded here dynamically -->
                </div>
            </div>
        </section>

        <!-- FAQ Page -->
        <section class="page" id="faqPage">
            <div class="container section">
                <h2 class="section-title">Frequently Asked Questions</h2>
                <p class="section-subtitle">Find answers to common questions about our e-book library and services.</p>
                
                <div class="faq-container" id="faqContainer">
                    <!-- FAQ items will be loaded here dynamically -->
                </div>
            </div>
        </section>

        <!-- Profile Page -->
        <section class="page" id="profilePage">
            <div class="container section">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <span class="material-symbols-rounded">person</span>
                    </div>
                    <h2 class="section-title">My Profile</h2>
                    <p class="section-subtitle">View and manage your account information</p>
                </div>
                
                <div class="profile-info" id="profileInfo">
                    <!-- Profile info will be loaded here dynamically -->
                </div>
                
                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-secondary" id="editProfileBtn">
                        <span class="material-symbols-rounded">edit</span>
                        Edit Profile
                    </button>
                    <button class="btn btn-primary" id="myBooksBtn">
                        <span class="material-symbols-rounded">library_books</span>
                        My Purchased Books
                    </button>
                </div>
            </div>
        </section>

        <!-- Admin Page -->
        <section class="page" id="adminPage">
            <div class="container section">
                <h2 class="section-title">Admin Dashboard</h2>
                <p class="section-subtitle">Manage books, users, and site content.</p>
                
                <div class="admin-actions">
                    <button class="btn btn-primary" id="addBookBtn">
                        <span class="material-symbols-rounded">add</span>
                        Add New Book
                    </button>
                    <button class="btn btn-secondary" id="refreshBooksBtn">
                        <span class="material-symbols-rounded">refresh</span>
                        Refresh List
                    </button>
                </div>
                
                <div class="books-list">
                    <h3 style="margin-bottom: 1.5rem;">All Books in Library</h3>
                    <div id="adminBooksList">
                        <!-- Admin books list will be loaded here -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Modal Overlay -->
    <div class="modal-overlay" id="modalOverlay"></div>

    <!-- Book Details Modal -->
    <div class="modal" id="bookDetailsModal" style="display: none;">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="material-symbols-rounded">info</span>
                Book Details
            </h2>
            <div class="modal-close" onclick="app.closeModal()">
                <span class="material-symbols-rounded">close</span>
            </div>
        </div>
        <div class="modal-body" id="bookDetailsContent">
            <!-- Book details will be loaded here -->
        </div>
    </div>

    <!-- Preview Book Modal -->
    <div class="modal" id="previewBookModal" style="display: none;">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="material-symbols-rounded">preview</span>
                Book Preview
            </h2>
            <div class="modal-close" onclick="app.closeModal()">
                <span class="material-symbols-rounded">close</span>
            </div>
        </div>
        <div class="modal-body" id="previewBookContent">
            <!-- Book preview will be loaded here -->
        </div>
    </div>

    <!-- Purchase Modal -->
    <div class="modal" id="purchaseModal" style="display: none;">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="material-symbols-rounded">shopping_cart</span>
                Complete Purchase
            </h2>
            <div class="modal-close" onclick="app.closeModal()">
                <span class="material-symbols-rounded">close</span>
            </div>
        </div>
        <div class="modal-body">
            <form id="purchaseForm">
                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">person</span>
                        Full Name
                    </label>
                    <input type="text" class="form-input" id="purchaseName" required placeholder="John Doe">
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">phone</span>
                            Phone Number
                        </label>
                        <input type="tel" class="form-input" id="purchasePhone" required placeholder="+995 123 456 789">
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">cake</span>
                            Age
                        </label>
                        <input type="number" class="form-input" id="purchaseAge" required min="13" max="120" placeholder="25">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">location_on</span>
                        Address
                    </label>
                    <textarea class="form-input" id="purchaseAddress" rows="3" required placeholder="Street, City, Country"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">email</span>
                        Email Address
                    </label>
                    <input type="email" class="form-input" id="purchaseEmail" required placeholder="john@example.com">
                </div>

                <!-- Payment Cards -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">credit_card</span>
                        Select Payment Method
                    </label>
                    <div class="payment-cards" id="paymentCardsContainer">
                        <!-- Payment cards will be loaded here -->
                    </div>
                    
                    <div class="add-card-btn" onclick="app.showAddCardModal()">
                        <span class="material-symbols-rounded" style="font-size: 2rem;">add</span>
                        <span>Add New Payment Card</span>
                    </div>
                </div>

                <div class="form-actions" style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" class="btn btn-secondary" onclick="app.closeModal()" style="flex: 1;">Cancel</button>
                    <button type="submit" class="btn btn-primary" style="flex: 1;">
                        <span class="material-symbols-rounded">lock</span>
                        Complete Purchase
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Card Modal -->
    <div class="modal" id="addCardModal" style="display: none;">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="material-symbols-rounded">credit_card</span>
                Add New Card
            </h2>
            <div class="modal-close" onclick="app.closeModal()">
                <span class="material-symbols-rounded">close</span>
            </div>
        </div>
        <div class="modal-body">
            <form id="addCardForm">
                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">badge</span>
                        Cardholder Name
                    </label>
                    <input type="text" class="form-input" id="cardName" required placeholder="JOHN DOE">
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">numbers</span>
                        Card Number
                    </label>
                    <input type="text" class="form-input" id="cardNumber" required placeholder="1234 5678 9012 3456" maxlength="19">
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">calendar_month</span>
                            Expiry Date
                        </label>
                        <input type="text" class="form-input" id="cardExpiry" required placeholder="MM/YY" maxlength="5">
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">lock</span>
                            CVV
                        </label>
                        <input type="text" class="form-input" id="cardCvv" required placeholder="123" maxlength="4">
                    </div>
                </div>

                <div class="form-actions" style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" class="btn btn-secondary" onclick="app.closeModal()" style="flex: 1;">Cancel</button>
                    <button type="submit" class="btn btn-primary" style="flex: 1;">
                        <span class="material-symbols-rounded">add_card</span>
                        Add Card
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal" id="authModal" style="display: none;">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="material-symbols-rounded">login</span>
                Welcome Back
            </h2>
            <div class="modal-close" onclick="app.closeModal()">
                <span class="material-symbols-rounded">close</span>
            </div>
        </div>
        <div class="modal-body">
            <form id="authForm">
                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">email</span>
                        Email Address
                    </label>
                    <input type="email" class="form-input" id="authEmail" required placeholder="you@example.com">
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">key</span>
                        Password
                    </label>
                    <input type="password" class="form-input" id="authPassword" required placeholder="">
                </div>

                <div class="form-actions" style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" class="btn btn-secondary" onclick="app.showSignupModal()" style="flex: 1;">
                        Create Account
                    </button>
                    <button type="submit" class="btn btn-primary" style="flex: 1;">
                        <span class="material-symbols-rounded">login</span>
                        Sign In
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal" id="signupModal" style="display: none;">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="material-symbols-rounded">person_add</span>
                Create Account
            </h2>
            <div class="modal-close" onclick="app.closeModal()">
                <span class="material-symbols-rounded">close</span>
            </div>
        </div>
        <div class="modal-body">
            <form id="signupForm">
                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">person</span>
                        Full Name
                    </label>
                    <input type="text" class="form-input" id="signupName" required placeholder="John Doe">
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">email</span>
                        Email Address
                    </label>
                    <input type="email" class="form-input" id="signupEmail" required placeholder="you@example.com">
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">phone</span>
                            Phone Number
                        </label>
                        <input type="tel" class="form-input" id="signupPhone" required placeholder="+995 123 456 789">
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">cake</span>
                            Age
                        </label>
                        <input type="number" class="form-input" id="signupAge" required min="13" max="120" placeholder="25">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">key</span>
                        Password
                    </label>
                    <input type="password" class="form-input" id="signupPassword" required placeholder="">
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">key</span>
                        Confirm Password
                    </label>
                    <input type="password" class="form-input" id="signupConfirmPassword" required placeholder="">
                </div>

                <div class="form-actions" style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" class="btn btn-secondary" onclick="app.showAuthModal()" style="flex: 1;">
                        Already have account?
                    </button>
                    <button type="submit" class="btn btn-primary" style="flex: 1;">
                        <span class="material-symbols-rounded">person_add</span>
                        Create Account
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Book Modal (Admin) -->
    <div class="modal" id="addBookModal" style="display: none;">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="material-symbols-rounded">menu_book</span>
                Add New Book
            </h2>
            <div class="modal-close" onclick="app.closeModal()">
                <span class="material-symbols-rounded">close</span>
            </div>
        </div>
        <div class="modal-body">
            <form id="addBookForm">
                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">title</span>
                        Book Title
                    </label>
                    <input type="text" class="form-input" id="bookTitle" required placeholder="Clean Code: A Handbook of Agile Software Craftsmanship">
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">person</span>
                            Author
                        </label>
                        <input type="text" class="form-input" id="bookAuthor" required placeholder="Robert C. Martin">
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">attach_money</span>
                            Price
                        </label>
                        <input type="number" class="form-input" id="bookPrice" required min="0" step="0.01" placeholder="29.99">
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">category</span>
                            Category
                        </label>
                        <select class="form-input" id="bookCategory" required>
                            <option value="web">Web Development</option>
                            <option value="mobile">Mobile Development</option>
                            <option value="data">Data Science</option>
                            <option value="ai">AI & Machine Learning</option>
                            <option value="devops">DevOps</option>
                            <option value="algorithms">Algorithms</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-rounded">school</span>
                            Difficulty
                        </label>
                        <select class="form-input" id="bookDifficulty" required>
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">description</span>
                        Description
                    </label>
                    <textarea class="form-input" id="bookDescription" rows="3" required placeholder="Learn how to write clean, maintainable code..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-rounded">image</span>
                        Cover Image URL
                    </label>
                    <input type="url" class="form-input" id="bookImage" required placeholder="https://picsum.photos/400/600?random=1">
                    <small style="color: var(--text-muted);">Use a reliable image service like picsum.photos</small>
                </div>

                <div class="form-actions" style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" class="btn btn-secondary" onclick="app.closeModal()" style="flex: 1;">Cancel</button>
                    <button type="submit" class="btn btn-primary" style="flex: 1;">
                        <span class="material-symbols-rounded">add</span>
                        Add Book
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Better Programmer</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        Your premier destination for programming education. 
                        Master the code, master the future.
                    </p>
                </div>

                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#" onclick="app.navigateTo('home')"><span class="material-symbols-rounded">home</span> Home</a></li>
                        <li><a href="#" onclick="app.navigateTo('books')"><span class="material-symbols-rounded">menu_book</span> E-Books</a></li>
                        <li><a href="#" onclick="app.navigateTo('categories')"><span class="material-symbols-rounded">category</span> Categories</a></li>
                        <li><a href="#" onclick="app.navigateTo('faq')"><span class="material-symbols-rounded">help</span> FAQ</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h3>Categories</h3>
                    <ul class="footer-links">
                        <li><a href="#" onclick="app.navigateTo('books'); app.setFilter('category', 'web')"><span class="material-symbols-rounded">code</span> Web Development</a></li>
                        <li><a href="#" onclick="app.navigateTo('books'); app.setFilter('category', 'mobile')"><span class="material-symbols-rounded">smartphone</span> Mobile Development</a></li>
                        <li><a href="#" onclick="app.navigateTo('books'); app.setFilter('category', 'data')"><span class="material-symbols-rounded">analytics</span> Data Science</a></li>
                        <li><a href="#" onclick="app.navigateTo('books'); app.setFilter('category', 'ai')"><span class="material-symbols-rounded">psychology</span> AI & ML</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h3>Support</h3>
                    <ul class="footer-links">
                        <li><a href="#" onclick="app.navigateTo('faq')"><span class="material-symbols-rounded">contact_support</span> Help Center</a></li>
                        <li><a href="#"><span class="material-symbols-rounded">email</span> Contact Us</a></li>
                        <li><a href="#"><span class="material-symbols-rounded">policy</span> Privacy Policy</a></li>
                        <li><a href="#"><span class="material-symbols-rounded">description</span> Terms</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p> 2024 Better Programmer. All rights reserved.</p>
                <p style="margin-top: 0.5rem; color: var(--text-muted);">
                    Made with <span style="color: var(--accent-blue);"></span> for developers worldwide
                </p>
            </div>
        </div>
    </footer>

    <script>
        class BetterProgrammerApp {
            constructor() {
                this.state = {
                    user: null,
                    books: [],
                    cart: [],
                    paymentCards: [],
                    currentBookId: null,
                    filters: {
                        category: 'all',
                        price: 'all',
                        sort: 'popular',
                        difficulty: 'all',
                        search: ''
                    }
                };
                
                this.init();
            }

            init() {
                this.loadData();
                this.initUI();
                this.setupEventListeners();
                this.renderBooks();
                this.updateCartCount();
                this.renderPaymentCards();
                this.renderCategories();
                this.renderFAQ();
                this.renderProfile();
                this.renderAdminBooks();
            }

            loadData() {
                // Load user from localStorage
                const savedUser = localStorage.getItem('bp_user');
                if (savedUser) {
                    this.state.user = JSON.parse(savedUser);
                }

                // Load cart from localStorage
                const savedCart = localStorage.getItem('bp_cart');
                if (savedCart) {
                    this.state.cart = JSON.parse(savedCart);
                }

                // Load payment cards
                const savedCards = localStorage.getItem('bp_cards');
                if (savedCards) {
                    this.state.paymentCards = JSON.parse(savedCards);
                } else {
                    this.state.paymentCards = [
                        {
                            id: 'card-1',
                            type: 'visa',
                            name: 'JOHN DOE',
                            number: '**** **** **** 4242',
                            last4: '4242',
                            expiry: '12/25'
                        },
                        {
                            id: 'card-2',
                            type: 'mastercard',
                            name: 'JOHN DOE',
                            number: '**** **** **** 5555',
                            last4: '5555',
                            expiry: '06/26'
                        }
                    ];
                    this.savePaymentCards();
                }

                // Load books from localStorage or use default
                const savedBooks = localStorage.getItem('bp_books');
                if (savedBooks) {
                    this.state.books = JSON.parse(savedBooks);
                } else {
                    this.state.books = this.getDefaultBooks();
                    this.saveBooks();
                }
            }

            getDefaultBooks() {
                return [
                    {
                        id: 'clean-code-' + Date.now(),
                        title: 'Clean Code: A Handbook of Agile Software Craftsmanship',
                        author: 'Robert C. Martin',
                        price: 29.99,
                        originalPrice: 39.99,
                        category: 'algorithms',
                        difficulty: 'intermediate',
                        rating: 4.7,
                        reviews: 1248,
                        description: 'Learn how to write clean, maintainable code that other developers will love to work with.',
                        longDescription: 'Even bad code can function. But if code isn\'t clean, it can bring a development organization to its knees. Every year, countless hours and significant resources are lost because of poorly written code. But it doesn\'t have to be that way.',
                        image: 'https://picsum.photos/400/600?random=1',
                        badges: ['popular', 'bestseller'],
                        pages: 464,
                        language: 'English',
                        published: '2008-08-01',
                        publisher: 'Prentice Hall',
                        topics: ['Software Architecture', 'Refactoring', 'Code Quality'],
                        previewContent: 'Chapter 1: Clean Code - What is clean code? This chapter introduces the concept of clean code and why it matters...'
                    },
                    {
                        id: 'eloquent-js-' + Date.now(),
                        title: 'Eloquent JavaScript',
                        author: 'Marijn Haverbeke',
                        price: 0,
                        category: 'web',
                        difficulty: 'beginner',
                        rating: 4.6,
                        reviews: 856,
                        description: 'A modern introduction to programming using JavaScript. Learn the fundamentals and advanced concepts.',
                        longDescription: 'This is a book about JavaScript, programming, and the wonders of the digital. You can read it online here, or buy your own paperback copy.',
                        image: 'https://picsum.photos/400/600?random=2',
                        badges: ['free', 'new'],
                        pages: 472,
                        language: 'English',
                        published: '2018-12-04',
                        publisher: 'No Starch Press',
                        topics: ['JavaScript', 'Web Development', 'Programming Basics'],
                        previewContent: 'Introduction: Welcome to the world of JavaScript. This book will guide you through the language...'
                    },
                    {
                        id: 'pragmatic-' + Date.now(),
                        title: 'The Pragmatic Programmer',
                        author: 'David Thomas & Andrew Hunt',
                        price: 39.99,
                        originalPrice: 49.99,
                        category: 'web',
                        difficulty: 'intermediate',
                        rating: 4.8,
                        reviews: 956,
                        description: 'Your journey to mastery, from apprentice to master craftsman.',
                        longDescription: 'The Pragmatic Programmer is one of those rare tech books you\'ll read, re-read, and read again over the years.',
                        image: 'https://picsum.photos/400/600?random=3',
                        badges: ['popular'],
                        pages: 352,
                        language: 'English',
                        published: '2019-09-13',
                        publisher: 'Addison-Wesley',
                        topics: ['Software Engineering', 'Career Development', 'Best Practices'],
                        previewContent: 'Chapter 1: A Pragmatic Philosophy - This chapter sets the tone for the entire book...'
                    },
                    {
                        id: 'design-patterns-' + Date.now(),
                        title: 'Design Patterns: Elements of Reusable Object-Oriented Software',
                        author: 'Erich Gamma, Richard Helm, Ralph Johnson, John Vlissides',
                        price: 49.99,
                        category: 'algorithms',
                        difficulty: 'advanced',
                        rating: 4.5,
                        reviews: 745,
                        description: 'The classic book on software design patterns. Essential reading for every serious developer.',
                        longDescription: 'Capturing a wealth of experience about the design of object-oriented software, four top-notch designers present a catalog of simple and succinct solutions to commonly occurring design problems.',
                        image: 'https://picsum.photos/400/600?random=4',
                        badges: [],
                        pages: 395,
                        language: 'English',
                        published: '1994-10-31',
                        publisher: 'Addison-Wesley',
                        topics: ['Design Patterns', 'Object-Oriented Design'],
                        previewContent: 'Introduction to Design Patterns - This book is about object-oriented design...'
                    },
                    {
                        id: 'python-crash-' + Date.now(),
                        title: 'Python Crash Course',
                        author: 'Eric Matthes',
                        price: 24.99,
                        originalPrice: 34.99,
                        category: 'data',
                        difficulty: 'beginner',
                        rating: 4.7,
                        reviews: 1123,
                        description: 'A hands-on, project-based introduction to programming with Python.',
                        longDescription: 'Python Crash Course is the world\'s bestselling programming book, with over 1,500,000 copies sold to date!',
                        image: 'https://picsum.photos/400/600?random=5',
                        badges: ['bestseller', 'popular'],
                        pages: 544,
                        language: 'English',
                        published: '2019-05-03',
                        publisher: 'No Starch Press',
                        topics: ['Python', 'Programming Basics', 'Data Analysis'],
                        previewContent: 'Getting Started with Python - This chapter introduces Python and shows you how to set up your development environment...'
                    },
                    {
                        id: 'deep-learning-' + Date.now(),
                        title: 'Deep Learning',
                        author: 'Ian Goodfellow, Yoshua Bengio, Aaron Courville',
                        price: 79.99,
                        category: 'ai',
                        difficulty: 'advanced',
                        rating: 4.4,
                        reviews: 324,
                        description: 'The definitive textbook on deep learning from the leading experts in the field.',
                        longDescription: 'The Deep Learning textbook is a resource intended to help students and practitioners enter the field of machine learning in general and deep learning in particular.',
                        image: 'https://picsum.photos/400/600?random=6',
                        badges: [],
                        pages: 800,
                        language: 'English',
                        published: '2016-11-18',
                        publisher: 'MIT Press',
                        topics: ['Deep Learning', 'Neural Networks', 'Machine Learning'],
                        previewContent: 'Introduction: Who Should Read This Book? - This book is intended to help people learn about deep learning...'
                    }
                ];
            }

            initUI() {
                // Update auth button based on user state
                this.updateAuthButton();
                
                // Show/hide admin nav based on user
                this.updateAdminNav();
            }

            setupEventListeners() {
                // Navigation
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const page = link.dataset.page;
                        this.navigateTo(page);
                    });
                });

                // Explore button
                document.getElementById('exploreBtn').addEventListener('click', () => {
                    this.navigateTo('books');
                });

                // Join free button
                document.getElementById('joinFreeBtn').addEventListener('click', () => {
                    this.showSignupModal();
                });

                // Auth button
                document.getElementById('authBtn').addEventListener('click', () => {
                    if (this.state.user) {
                        this.logout();
                    } else {
                        this.showAuthModal();
                    }
                });

                // Cart button
                document.getElementById('cartBtn').addEventListener('click', () => {
                    this.showCart();
                });

                // Search
                document.getElementById('searchInput').addEventListener('input', (e) => {
                    this.state.filters.search = e.target.value;
                    this.filterAndRenderBooks();
                });

                // Filters
                document.getElementById('categoryFilter').addEventListener('change', (e) => {
                    this.state.filters.category = e.target.value;
                    this.filterAndRenderBooks();
                });

                document.getElementById('priceFilter').addEventListener('change', (e) => {
                    this.state.filters.price = e.target.value;
                    this.filterAndRenderBooks();
                });

                document.getElementById('sortFilter').addEventListener('change', (e) => {
                    this.state.filters.sort = e.target.value;
                    this.filterAndRenderBooks();
                });

                document.getElementById('difficultyFilter').addEventListener('change', (e) => {
                    this.state.filters.difficulty = e.target.value;
                    this.filterAndRenderBooks();
                });

                // Reset filters
                document.getElementById('resetFilters').addEventListener('click', () => {
                    this.resetFilters();
                });

                // Load more button
                document.getElementById('loadMoreBtn').addEventListener('click', () => {
                    this.loadMoreBooks();
                });

                // Forms
                document.getElementById('authForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleLogin();
                });

                document.getElementById('signupForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleSignup();
                });

                document.getElementById('purchaseForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handlePurchase();
                });

                document.getElementById('addCardForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleAddCard();
                });

                document.getElementById('addBookForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleAddBook();
                });

                // Profile buttons
                document.getElementById('editProfileBtn').addEventListener('click', () => {
                    this.showEditProfileModal();
                });

                // Admin buttons
                document.getElementById('addBookBtn').addEventListener('click', () => {
                    this.showAddBookModal();
                });

                document.getElementById('refreshBooksBtn').addEventListener('click', () => {
                    this.renderAdminBooks();
                    this.showToast('Books list refreshed', 'success');
                });

                // Modal overlay
                document.getElementById('modalOverlay').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('modalOverlay')) {
                        this.closeModal();
                    }
                });

                // Escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeModal();
                    }
                });
            }

            navigateTo(page) {
                // Update active nav link
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.dataset.page === page) {
                        link.classList.add('active');
                    }
                });

                // Hide all pages and show the selected one
                document.querySelectorAll('.page').forEach(pageElement => {
                    pageElement.classList.remove('active');
                });

                const targetPage = document.getElementById(page + 'Page');
                if (targetPage) {
                    targetPage.classList.add('active');
                    
                    // Scroll to top of main content
                    document.getElementById('mainContent').scrollIntoView({ behavior: 'smooth' });
                }

                // Special handling for certain pages
                if (page === 'books') {
                    this.filterAndRenderBooks();
                } else if (page === 'profile') {
                    this.renderProfile();
                } else if (page === 'admin') {
                    this.renderAdminBooks();
                }
            }

            renderBooks() {
                const booksGrid = document.getElementById('booksGrid');
                if (!booksGrid) return;

                const books = this.getFilteredBooks();
                
                if (books.length === 0) {
                    booksGrid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 4rem; color: var(--text-secondary);">
                            <span class="material-symbols-rounded" style="font-size: 4rem; margin-bottom: 1rem;">search_off</span>
                            <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">No books found</h3>
                            <p>Try adjusting your filters or search terms</p>
                        </div>
                    `;
                    return;
                }

                booksGrid.innerHTML = books.map(book => `
                    <div class="book-card" data-id="${book.id}">
                        <div class="book-cover">
                            <img src="${book.image}" alt="${book.title}" class="book-image" onerror="this.src='https://picsum.photos/400/600?book'">
                            <div class="book-badges">
                                ${book.price === 0 ? '<div class="badge badge-free">FREE</div>' : ''}
                                ${book.badges && book.badges.includes('new') ? '<div class="badge badge-new">NEW</div>' : ''}
                                ${book.badges && (book.badges.includes('popular') || book.badges.includes('bestseller')) ? '<div class="badge badge-popular">POPULAR</div>' : ''}
                            </div>
                        </div>
                        
                        <div class="book-info">
                            <h3 class="book-title">${book.title}</h3>
                            <div class="book-author">
                                <span class="material-symbols-rounded" style="font-size: 1rem;">person</span>
                                ${book.author}
                            </div>
                            <p class="book-description">${book.description}</p>
                            
                            <div class="book-meta">
                                <span class="book-category">${this.getCategoryName(book.category)}</span>
                                <div class="book-rating">
                                    <span>${book.rating ? book.rating.toFixed(1) : '4.5'}</span>
                                    <span class="material-symbols-rounded" style="color: var(--accent-orange);">star</span>
                                    <span style="color: var(--text-muted); font-size: 0.8rem;">(${book.reviews || '100'})</span>
                                </div>
                            </div>
                            
                            <div class="book-price-section">
                                <div>
                                    <div class="book-price ${book.price === 0 ? 'book-price-free' : ''}">
                                        ${book.price === 0 ? 'FREE' : '$' + book.price.toFixed(2)}
                                    </div>
                                    ${book.originalPrice ? `
                                        <div style="color: var(--text-muted); text-decoration: line-through; font-size: 0.9rem;">$${book.originalPrice.toFixed(2)}</div>
                                    ` : ''}
                                </div>
                                <div style="color: var(--text-muted); font-size: 0.85rem;">
                                    ${book.pages || '300'} pages
                                </div>
                            </div>
                            
                            <div class="book-actions">
                                <button class="btn btn-primary btn-small" onclick="app.buyBook('${book.id}')">
                                    <span class="material-symbols-rounded">shopping_cart</span>
                                    ${book.price === 0 ? 'Get Free' : 'Buy Now'}
                                </button>
                                <button class="btn btn-secondary btn-small" onclick="app.showBookDetails('${book.id}')">
                                    <span class="material-symbols-rounded">info</span>
                                    Details
                                </button>
                                <button class="btn btn-secondary btn-fullwidth btn-small" onclick="app.showBookPreview('${book.id}')">
                                    <span class="material-symbols-rounded">visibility</span>
                                    Preview Book
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            getFilteredBooks() {
                let filtered = [...this.state.books];

                // Apply category filter
                if (this.state.filters.category !== 'all') {
                    filtered = filtered.filter(book => book.category === this.state.filters.category);
                }

                // Apply price filter
                switch (this.state.filters.price) {
                    case 'free':
                        filtered = filtered.filter(book => book.price === 0);
                        break;
                    case 'paid':
                        filtered = filtered.filter(book => book.price > 0);
                        break;
                    case 'under-20':
                        filtered = filtered.filter(book => book.price < 20);
                        break;
                    case '20-50':
                        filtered = filtered.filter(book => book.price >= 20 && book.price <= 50);
                        break;
                    case 'over-50':
                        filtered = filtered.filter(book => book.price > 50);
                        break;
                }

                // Apply difficulty filter
                if (this.state.filters.difficulty !== 'all') {
                    filtered = filtered.filter(book => book.difficulty === this.state.filters.difficulty);
                }

                // Apply search filter
                if (this.state.filters.search.trim()) {
                    const searchTerm = this.state.filters.search.toLowerCase();
                    filtered = filtered.filter(book => 
                        book.title.toLowerCase().includes(searchTerm) ||
                        book.author.toLowerCase().includes(searchTerm) ||
                        book.description.toLowerCase().includes(searchTerm)
                    );
                }

                // Apply sorting
                filtered.sort((a, b) => {
                    switch (this.state.filters.sort) {
                        case 'newest':
                            return new Date(b.published || '2000-01-01') - new Date(a.published || '2000-01-01');
                        case 'rating':
                            return (b.rating || 0) - (a.rating || 0);
                        case 'price-low':
                            return a.price - b.price;
                        case 'price-high':
                            return b.price - a.price;
                        case 'popular':
                        default:
                            return (b.reviews || 0) - (a.reviews || 0);
                    }
                });

                return filtered;
            }

            filterAndRenderBooks() {
                this.renderBooks();
            }

            resetFilters() {
                this.state.filters = {
                    category: 'all',
                    price: 'all',
                    sort: 'popular',
                    difficulty: 'all',
                    search: ''
                };

                // Reset UI elements
                document.getElementById('categoryFilter').value = 'all';
                document.getElementById('priceFilter').value = 'all';
                document.getElementById('sortFilter').value = 'popular';
                document.getElementById('difficultyFilter').value = 'all';
                document.getElementById('searchInput').value = '';

                this.renderBooks();
                this.showToast('Filters reset', 'success');
            }

            setFilter(filterName, value) {
                this.state.filters[filterName] = value;
                this.filterAndRenderBooks();
            }

            loadMoreBooks() {
                // Simulate loading more books
                this.showToast('Loading more books...', 'info');
                setTimeout(() => {
                    this.showToast('No more books to load', 'info');
                }, 1000);
            }

            buyBook(bookId) {
                const book = this.state.books.find(b => b.id === bookId);
                if (!book) return;

                if (!this.state.user) {
                    this.showToast('Please sign in to purchase books', 'warning');
                    this.showAuthModal();
                    return;
                }

                this.state.currentBookId = bookId;
                this.showPurchaseModal(book);
            }

            showPurchaseModal(book) {
                this.openModal('purchaseModal');
                
                // Auto-fill user info if available
                if (this.state.user) {
                    document.getElementById('purchaseName').value = this.state.user.name || '';
                    document.getElementById('purchaseEmail').value = this.state.user.email || '';
                    document.getElementById('purchasePhone').value = this.state.user.phone || '';
                    document.getElementById('purchaseAge').value = this.state.user.age || '';
                    document.getElementById('purchaseAddress').value = this.state.user.address || '';
                }
            }

            handlePurchase() {
                // Get form data
                const name = document.getElementById('purchaseName').value.trim();
                const phone = document.getElementById('purchasePhone').value.trim();
                const age = document.getElementById('purchaseAge').value.trim();
                const address = document.getElementById('purchaseAddress').value.trim();
                const email = document.getElementById('purchaseEmail').value.trim();
                
                // Validation
                if (!name || !phone || !age || !address || !email) {
                    this.showToast('Please fill in all required fields', 'error');
                    return;
                }

                if (age < 13 || age > 120) {
                    this.showToast('Age must be between 13 and 120', 'error');
                    return;
                }

                // Check if payment card is selected
                const selectedCard = document.querySelector('.payment-card.selected');
                if (!selectedCard) {
                    this.showToast('Please select a payment method', 'error');
                    return;
                }

                // Get book
                const book = this.state.books.find(b => b.id === this.state.currentBookId);
                if (!book) return;

                // Process purchase
                this.showToast('Processing your purchase...', 'info');

                setTimeout(() => {
                    // Add to cart
                    this.addToCart(book.id);
                    
                    // Update user info
                    this.state.user = {
                        ...this.state.user,
                        name,
                        email,
                        phone,
                        age: parseInt(age),
                        address
                    };
                    this.saveUser();

                    this.showToast(`Successfully purchased "${book.title}"!`, 'success');
                    this.closeModal();
                    document.getElementById('purchaseForm').reset();
                    this.updateUI();
                }, 2000);
            }

            showBookDetails(bookId) {
                const book = this.state.books.find(b => b.id === bookId);
                if (!book) return;

                const content = `
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 2rem; margin-bottom: 2rem;">
                        <div>
                            <img src="${book.image}" alt="${book.title}" style="width: 100%; border-radius: 12px; box-shadow: var(--shadow-lg);" onerror="this.src='https://picsum.photos/400/600?book'">
                        </div>
                        <div>
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);">${book.title}</h3>
                            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">${book.longDescription || book.description}</p>
                            
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                                <div>
                                    <div style="color: var(--text-muted); font-size: 0.875rem;">Pages</div>
                                    <div style="color: var(--text-primary); font-weight: 600;">${book.pages || '300'}</div>
                                </div>
                                <div>
                                    <div style="color: var(--text-muted); font-size: 0.875rem;">Language</div>
                                    <div style="color: var(--text-primary); font-weight: 600;">${book.language || 'English'}</div>
                                </div>
                                <div>
                                    <div style="color: var(--text-muted); font-size: 0.875rem;">Published</div>
                                    <div style="color: var(--text-primary); font-weight: 600;">${new Date(book.published || '2000-01-01').toLocaleDateString()}</div>
                                </div>
                                <div>
                                    <div style="color: var(--text-muted); font-size: 0.875rem;">Publisher</div>
                                    <div style="color: var(--text-primary); font-weight: 600;">${book.publisher || 'Unknown'}</div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 1.5rem;">
                                <div style="color: var(--text-muted); font-size: 0.875rem; margin-bottom: 0.5rem;">Topics Covered</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                    ${(book.topics || ['Programming', 'Software Development']).map(topic => `
                                        <span style="padding: 0.25rem 0.75rem; background: rgba(59, 130, 246, 0.1); border: 1px solid var(--border-light); border-radius: 20px; font-size: 0.75rem; color: var(--accent-blue);">
                                            ${topic}
                                        </span>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-primary" onclick="app.buyBook('${book.id}'); app.closeModal();">
                            <span class="material-symbols-rounded">shopping_cart</span>
                            ${book.price === 0 ? 'Get Free' : 'Buy for $' + book.price.toFixed(2)}
                        </button>
                        <button class="btn btn-secondary" onclick="app.showBookPreview('${book.id}'); app.closeModal();">
                            <span class="material-symbols-rounded">preview</span>
                            Preview Book
                        </button>
                    </div>
                `;
                
                document.getElementById('bookDetailsContent').innerHTML = content;
                this.openModal('bookDetailsModal');
            }

            showBookPreview(bookId) {
                const book = this.state.books.find(b => b.id === bookId);
                if (!book) return;

                const content = `
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <img src="${book.image}" alt="${book.title}" style="width: 200px; border-radius: 12px; box-shadow: var(--shadow-lg); margin-bottom: 1rem;" onerror="this.src='https://picsum.photos/400/600?book'">
                        <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">${book.title}</h3>
                        <p style="color: var(--text-secondary);">Preview Chapter 1</p>
                    </div>
                    
                    <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-light); border-radius: 12px; padding: 2rem; max-height: 400px; overflow-y: auto;">
                        <div style="color: var(--text-secondary); line-height: 1.8; font-size: 0.95rem;">
                            ${book.previewContent || 'No preview available for this book.'}
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 2rem; justify-content: center;">
                        <button class="btn btn-primary" onclick="app.buyBook('${book.id}'); app.closeModal();">
                            <span class="material-symbols-rounded">shopping_cart</span>
                            ${book.price === 0 ? 'Get Full Book Free' : 'Buy Full Book'}
                        </button>
                        <button class="btn btn-secondary" onclick="app.showBookDetails('${book.id}'); app.closeModal();">
                            <span class="material-symbols-rounded">info</span>
                            View Details
                        </button>
                    </div>
                `;
                
                document.getElementById('previewBookContent').innerHTML = content;
                this.openModal('previewBookModal');
            }

            addToCart(bookId) {
                const book = this.state.books.find(b => b.id === bookId);
                if (!book) return;

                const existingItem = this.state.cart.find(item => item.id === bookId);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    this.state.cart.push({
                        id: bookId,
                        title: book.title,
                        price: book.price,
                        image: book.image,
                        quantity: 1
                    });
                }

                this.saveCart();
                this.updateCartCount();
                this.showToast(`Added "${book.title}" to cart`, 'success');
            }

            showCart() {
                if (this.state.cart.length === 0) {
                    this.showToast('Your cart is empty', 'info');
                    return;
                }

                this.showToast(`You have ${this.state.cart.length} item(s) in cart`, 'info');
            }

            updateCartCount() {
                const count = this.state.cart.reduce((total, item) => total + item.quantity, 0);
                document.getElementById('cartCount').textContent = count;
            }

            saveCart() {
                localStorage.setItem('bp_cart', JSON.stringify(this.state.cart));
            }

            renderPaymentCards() {
                const container = document.getElementById('paymentCardsContainer');
                if (!container) return;

                container.innerHTML = this.state.paymentCards.map(card => `
                    <div class="payment-card" data-card-id="${card.id}" onclick="app.selectPaymentCard('${card.id}')">
                        <div class="payment-card-header">
                            <div class="payment-card-type">
                                <span class="material-symbols-rounded">credit_card</span>
                                ${card.type.toUpperCase()}
                            </div>
                            <div class="payment-card-number">${card.number}</div>
                        </div>
                        <div style="color: var(--text-secondary); font-size: 0.875rem;">
                            ${card.name}  Expires ${card.expiry}
                        </div>
                    </div>
                `).join('');

                // Select first card by default
                if (this.state.paymentCards.length > 0) {
                    this.selectPaymentCard(this.state.paymentCards[0].id);
                }
            }

            selectPaymentCard(cardId) {
                document.querySelectorAll('.payment-card').forEach(card => {
                    card.classList.remove('selected');
                });

                const selectedCard = document.querySelector(`[data-card-id="${cardId}"]`);
                if (selectedCard) {
                    selectedCard.classList.add('selected');
                }
            }

            showAddCardModal() {
                this.openModal('addCardModal');
            }

            handleAddCard() {
                const name = document.getElementById('cardName').value.trim();
                const number = document.getElementById('cardNumber').value.trim();
                const expiry = document.getElementById('cardExpiry').value.trim();
                const cvv = document.getElementById('cardCvv').value.trim();

                // Validation
                if (!name || !number || !expiry || !cvv) {
                    this.showToast('Please fill in all card details', 'error');
                    return;
                }

                const cardNumber = number.replace(/\s/g, '');
                if (cardNumber.length !== 16 || !/^\d+$/.test(cardNumber)) {
                    this.showToast('Please enter a valid 16-digit card number', 'error');
                    return;
                }

                if (!/^\d{2}\/\d{2}$/.test(expiry)) {
                    this.showToast('Please enter expiry date in MM/YY format', 'error');
                    return;
                }

                if (!/^\d{3,4}$/.test(cvv)) {
                    this.showToast('Please enter a valid CVV (3 or 4 digits)', 'error');
                    return;
                }

                let cardType = 'visa';
                if (cardNumber.startsWith('5')) {
                    cardType = 'mastercard';
                } else if (cardNumber.startsWith('4')) {
                    cardType = 'visa';
                } else if (cardNumber.startsWith('3')) {
                    cardType = 'amex';
                }

                const newCard = {
                    id: 'card-' + Date.now(),
                    type: cardType,
                    name: name.toUpperCase(),
                    number: `**** **** **** ${cardNumber.slice(-4)}`,
                    last4: cardNumber.slice(-4),
                    expiry: expiry
                };

                this.state.paymentCards.push(newCard);
                this.savePaymentCards();
                this.renderPaymentCards();
                this.selectPaymentCard(newCard.id);

                this.closeModal();
                document.getElementById('addCardForm').reset();
                this.showToast('Payment card added successfully', 'success');
            }

            savePaymentCards() {
                localStorage.setItem('bp_cards', JSON.stringify(this.state.paymentCards));
            }

            renderCategories() {
                const container = document.getElementById('categoriesGrid');
                if (!container) return;

                const categories = [
                    { id: 'web', name: 'Web Development', icon: 'code', count: 45 },
                    { id: 'mobile', name: 'Mobile Development', icon: 'smartphone', count: 32 },
                    { id: 'data', name: 'Data Science', icon: 'analytics', count: 28 },
                    { id: 'ai', name: 'AI & Machine Learning', icon: 'psychology', count: 36 },
                    { id: 'devops', name: 'DevOps', icon: 'settings', count: 24 },
                    { id: 'algorithms', name: 'Algorithms', icon: 'functions', count: 41 },
                    { id: 'security', name: 'Cyber Security', icon: 'security', count: 19 },
                    { id: 'cloud', name: 'Cloud Computing', icon: 'cloud', count: 22 }
                ];

                container.innerHTML = categories.map(cat => `
                    <div class="category-card" onclick="app.navigateTo('books'); app.setFilter('category', '${cat.id}')">
                        <div class="category-icon">
                            <span class="material-symbols-rounded">${cat.icon}</span>
                        </div>
                        <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">${cat.name}</h3>
                        <p style="color: var(--text-secondary);">${cat.count} Books</p>
                    </div>
                `).join('');
            }

            renderFAQ() {
                const container = document.getElementById('faqContainer');
                if (!container) return;

                const faqs = [
                    {
                        q: 'How do I purchase a book?',
                        a: 'Simply click the "Buy Now" button on any book card, complete the payment form, and the book will be added to your library.'
                    },
                    {
                        q: 'Are there any free books?',
                        a: 'Yes! We offer a selection of free programming books. Look for the "FREE" badge on book cards.'
                    },
                    {
                        q: 'Can I read books on multiple devices?',
                        a: 'Yes, once purchased, you can access your books from any device by logging into your account.'
                    },
                    {
                        q: 'What payment methods do you accept?',
                        a: 'We accept all major credit cards (Visa, MasterCard, American Express) and PayPal.'
                    },
                    {
                        q: 'How do I get a refund?',
                        a: 'We offer refunds within 30 days of purchase. Contact our support team for assistance.'
                    }
                ];

                container.innerHTML = faqs.map((faq, index) => `
                    <div class="faq-item" id="faq-${index}">
                        <div class="faq-question" onclick="app.toggleFAQ(${index})">
                            <span>${faq.q}</span>
                            <span class="material-symbols-rounded">expand_more</span>
                        </div>
                        <div class="faq-answer">
                            ${faq.a}
                        </div>
                    </div>
                `).join('');
            }

            toggleFAQ(index) {
                const faqItem = document.getElementById(`faq-${index}`);
                faqItem.classList.toggle('active');
            }

            renderProfile() {
                const container = document.getElementById('profileInfo');
                if (!container) return;

                if (!this.state.user) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 3rem;">
                            <span class="material-symbols-rounded" style="font-size: 4rem; color: var(--text-muted); margin-bottom: 1rem;">person_off</span>
                            <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">Not Signed In</h3>
                            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Please sign in to view your profile</p>
                            <button class="btn btn-primary" onclick="app.showAuthModal()">Sign In</button>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = `
                    <div class="info-row">
                        <span style="color: var(--text-secondary);">Full Name</span>
                        <span style="color: var(--text-primary); font-weight: 500;">${this.state.user.name || 'Not set'}</span>
                    </div>
                    <div class="info-row">
                        <span style="color: var(--text-secondary);">Email Address</span>
                        <span style="color: var(--text-primary); font-weight: 500;">${this.state.user.email || 'Not set'}</span>
                    </div>
                    <div class="info-row">
                        <span style="color: var(--text-secondary);">Phone Number</span>
                        <span style="color: var(--text-primary); font-weight: 500;">${this.state.user.phone || 'Not set'}</span>
                    </div>
                    <div class="info-row">
                        <span style="color: var(--text-secondary);">Age</span>
                        <span style="color: var(--text-primary); font-weight: 500;">${this.state.user.age || 'Not set'}</span>
                    </div>
                    <div class="info-row">
                        <span style="color: var(--text-secondary);">Member Since</span>
                        <span style="color: var(--text-primary); font-weight: 500;">${new Date(this.state.user.joinedAt || Date.now()).toLocaleDateString()}</span>
                    </div>
                    <div class="info-row">
                        <span style="color: var(--text-secondary);">Books Purchased</span>
                        <span style="color: var(--text-primary); font-weight: 500;">${this.state.cart.length}</span>
                    </div>
                `;
            }

            showEditProfileModal() {
                // Simple edit functionality - just update from current purchase form
                this.showToast('Use the purchase form to update your profile information', 'info');
                this.showPurchaseModal({ title: 'Update Profile' });
            }

            renderAdminBooks() {
                const container = document.getElementById('adminBooksList');
                if (!container) return;

                if (this.state.books.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-secondary); text-align: center; padding: 2rem;">No books in library</p>';
                    return;
                }

                container.innerHTML = this.state.books.map(book => `
                    <div class="book-list-item">
                        <div>
                            <strong style="color: var(--text-primary);">${book.title}</strong>
                            <div style="color: var(--text-secondary); font-size: 0.9rem;">${book.author}  ${this.getCategoryName(book.category)}</div>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 0.8rem;" onclick="app.editBook('${book.id}')">
                                <span class="material-symbols-rounded" style="font-size: 1rem;">edit</span>
                            </button>
                            <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 0.8rem; background: rgba(239, 68, 68, 0.1); color: #ef4444;" onclick="app.deleteBook('${book.id}')">
                                <span class="material-symbols-rounded" style="font-size: 1rem;">delete</span>
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            showAddBookModal() {
                this.openModal('addBookModal');
            }

            handleAddBook() {
                const title = document.getElementById('bookTitle').value.trim();
                const author = document.getElementById('bookAuthor').value.trim();
                const price = parseFloat(document.getElementById('bookPrice').value);
                const category = document.getElementById('bookCategory').value;
                const difficulty = document.getElementById('bookDifficulty').value;
                const description = document.getElementById('bookDescription').value.trim();
                const image = document.getElementById('bookImage').value.trim();

                // Validation
                if (!title || !author || isNaN(price) || !category || !difficulty || !description || !image) {
                    this.showToast('Please fill in all required fields', 'error');
                    return;
                }

                const newBook = {
                    id: 'book-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                    title,
                    author,
                    price,
                    category,
                    difficulty,
                    description,
                    longDescription: description,
                    image,
                    rating: 4.5,
                    reviews: 100,
                    badges: ['new'],
                    pages: 300,
                    language: 'English',
                    published: new Date().toISOString().split('T')[0],
                    publisher: 'Better Programmer Press',
                    topics: [this.getCategoryName(category)],
                    previewContent: 'This is a preview of ' + title + '. The full book contains comprehensive coverage of ' + this.getCategoryName(category) + ' topics.'
                };

                this.state.books.push(newBook);
                this.saveBooks();
                this.renderBooks();
                this.renderAdminBooks();
                
                this.closeModal();
                document.getElementById('addBookForm').reset();
                this.showToast(`Book "${title}" added successfully`, 'success');
            }

            editBook(bookId) {
                this.showToast('Edit book functionality coming soon!', 'info');
            }

            deleteBook(bookId) {
                if (confirm('Are you sure you want to delete this book?')) {
                    const index = this.state.books.findIndex(b => b.id === bookId);
                    if (index !== -1) {
                        const bookTitle = this.state.books[index].title;
                        this.state.books.splice(index, 1);
                        this.saveBooks();
                        this.renderBooks();
                        this.renderAdminBooks();
                        this.showToast(`Book "${bookTitle}" deleted`, 'success');
                    }
                }
            }

            saveBooks() {
                localStorage.setItem('bp_books', JSON.stringify(this.state.books));
            }

            showAuthModal() {
                this.openModal('authModal');
            }

            showSignupModal() {
                this.openModal('signupModal');
            }

            handleLogin() {
                const email = document.getElementById('authEmail').value.trim();
                const password = document.getElementById('authPassword').value.trim();

                if (!email || !password) {
                    this.showToast('Please enter email and password', 'error');
                    return;
                }

                // Check for admin login
                if (email === 'admin@example.com' && password === 'admin123') {
                    this.state.user = {
                        id: 'user-admin',
                        email,
                        name: 'Admin User',
                        phone: '+995 555 555 555',
                        age: 30,
                        joinedAt: new Date().toISOString(),
                        isAdmin: true
                    };
                } else {
                    // Regular user login
                    this.state.user = {
                        id: 'user-' + Date.now(),
                        email,
                        name: 'John Doe',
                        phone: '+995 123 456 789',
                        age: 25,
                        joinedAt: new Date().toISOString(),
                        isAdmin: false
                    };
                }

                this.saveUser();
                this.updateUI();
                this.closeModal();
                document.getElementById('authForm').reset();
                this.showToast('Successfully signed in!', 'success');
            }

            handleSignup() {
                const name = document.getElementById('signupName').value.trim();
                const email = document.getElementById('signupEmail').value.trim();
                const phone = document.getElementById('signupPhone').value.trim();
                const age = document.getElementById('signupAge').value.trim();
                const password = document.getElementById('signupPassword').value.trim();
                const confirmPassword = document.getElementById('signupConfirmPassword').value.trim();

                if (!name || !email || !phone || !age || !password || !confirmPassword) {
                    this.showToast('Please fill in all fields', 'error');
                    return;
                }

                if (password !== confirmPassword) {
                    this.showToast('Passwords do not match', 'error');
                    return;
                }

                if (age < 13 || age > 120) {
                    this.showToast('Age must be between 13 and 120', 'error');
                    return;
                }

                this.state.user = {
                    id: 'user-' + Date.now(),
                    name,
                    email,
                    phone,
                    age: parseInt(age),
                    joinedAt: new Date().toISOString(),
                    isAdmin: false
                };

                this.saveUser();
                this.updateUI();
                this.closeModal();
                document.getElementById('signupForm').reset();
                this.showToast('Account created successfully!', 'success');
            }

            logout() {
                this.state.user = null;
                localStorage.removeItem('bp_user');
                this.updateUI();
                this.navigateTo('home');
                this.showToast('Successfully logged out', 'info');
            }

            saveUser() {
                localStorage.setItem('bp_user', JSON.stringify(this.state.user));
            }

            updateUI() {
                const authBtn = document.getElementById('authBtn');
                if (this.state.user) {
                    authBtn.textContent = 'LOGOUT';
                    authBtn.innerHTML = '<span class="material-symbols-rounded">logout</span> LOGOUT';
                } else {
                    authBtn.textContent = 'SIGN IN';
                    authBtn.innerHTML = '<span class="material-symbols-rounded">login</span> SIGN IN';
                }

                this.updateCartCount();
                this.updateAdminNav();
                this.renderProfile();
            }

            updateAdminNav() {
                const adminNavLink = document.getElementById('adminNavLink');
                if (adminNavLink) {
                    if (this.state.user && this.state.user.isAdmin) {
                        adminNavLink.style.display = 'flex';
                    } else {
                        adminNavLink.style.display = 'none';
                    }
                }
            }

            updateAuthButton() {
                this.updateUI();
            }

            openModal(modalId) {
                const modal = document.getElementById(modalId);
                const overlay = document.getElementById('modalOverlay');
                
                modal.style.display = 'block';
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            closeModal() {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
                
                const overlay = document.getElementById('modalOverlay');
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            }

            showToast(message, type = 'info') {
                const container = document.getElementById('toastContainer');
                
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.innerHTML = `
                    <div style="flex: 1;">
                        <div style="font-weight: 600; margin-bottom: 0.25rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span class="material-symbols-rounded">
                                ${type === 'success' ? 'check_circle' : 
                                  type === 'error' ? 'error' : 
                                  type === 'warning' ? 'warning' : 'info'}
                            </span>
                            ${type.charAt(0).toUpperCase() + type.slice(1)}
                        </div>
                        <div>${message}</div>
                    </div>
                    <span class="material-symbols-rounded" style="cursor: pointer;" onclick="this.parentElement.remove()">close</span>
                `;
                
                container.appendChild(toast);
                
                setTimeout(() => toast.classList.add('show'), 10);
                
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (toast.parentNode === container) {
                            container.removeChild(toast);
                        }
                    }, 300);
                }, 3000);
            }

            getCategoryName(category) {
                const categories = {
                    'web': 'Web Development',
                    'mobile': 'Mobile Development',
                    'data': 'Data Science',
                    'ai': 'AI & Machine Learning',
                    'devops': 'DevOps',
                    'algorithms': 'Algorithms'
                };
                return categories[category] || category;
            }
        }

        // Create global app instance
        const app = new BetterProgrammerApp();

        // Global helper functions (for inline onclick handlers)
        window.app = app;
    </script>
</body>
</html>
